<breadcrumbs crumbs=crumbs></breadcrumbs>

<h1>
  <span ng-show='profile == null'>Loading profile</span>
  <span ng-show='profile != null'>{{profile.username}}</span>
  <small ng-show='profile != null'>on {{profile.siteName}}</small>
  <img ng-show='loading > 0' src='/static/img/spinner-blue-on-white.gif'>
</h1>

<div ng-if='profile != null'>
  <div class='row'>
    <div class='col-md-4'>
      <figure class='avatar'>
        <a href='{{api.authorizeUrl(profile.avatarUrl)}}'
           target='_blank'
           title='Click to download avatar image.'>
          <img ng-src='{{api.authorizeUrl(profile.avatarUrl)}}'>
        </a>
        <figcaption>
          <p>
            {{profile.description}}
          </p>
        </figcaption>
      </figure>
    </div>

    <div class='col-md-8'>
      <div class='row' ng-show='profile.isStub'>
        <div class='col-sm-12'>
          <div class="alert alert-info" role="alert">
            <p>
              <strong>This profile is a stub!</strong>
            </p>
            <p>
              It appears here because it is a friend or follower of another
              profile in QuickPin, but no posts or additional
              friends/followers have been fetched. You can fetch the full
              profile from {{profile.siteName}} by clicking the button below.
            </p>
            <p>
              <button class='btn btn-default'>
                Fetch Full Profile
              </button>
            </p>
          </div>
        </div>
      </div>

      <div class='row'>
        <div class='col-sm-4'>
          <div class='card blue'>
            <div class='content'>
              {{profile.friendCount | number | default:'n/a'}}
            </div>
            <div class='legend'>Friends</div>
            <i class='fa fa-asterisk'></i>
          </div>
        </div>
        <div class='col-sm-4'>
          <div class='card green'>
            <div class='content'>
              {{profile.followerCount | number | default:'n/a'}}
            </div>
            <div class='legend'>Followers</div>
            <i class='fa fa-group'></i>
          </div>
        </div>
        <div class='col-sm-4'>
          <div class='card red'>
            <div class='content'>
              {{profile.postCount | number | default:'n/a'}}
            </div>
            <div class='legend'>Posts</div>
            <i class='fa fa-quote-right'></i>
          </div>
        </div>
      </div>
      <div class='row'>
        <div class='col-sm-4'>
          <div class='card yellow'>
            <div class='content small'>
              {{profile.name | default:'Unknown'}}
            </div>
            <div class='legend'>Name</div>
            <i class='fa fa-lock'></i>
          </div>
        </div>
        <div class='col-sm-4'>
          <div class='card blue'>
            <div class='content small'>
              {{profile.location | default:'Unknown'}}
            </div>
            <div class='legend'>Location</div>
            <i class='fa fa-map-marker'></i>
          </div>
        </div>
        <div class='col-sm-4'>
          <div class='card green'>
            <div class='content small'>
              {{profile.joinDate | date:"MMM d, yyyy" | default:'Unknown'}}
            </div>
            <div class='legend'>Joined</div>
            <i class='fa fa-heart'></i>
          </div>
        </div>
      </div>
      <p>
        <em>
          Last updated from {{profile.siteName}}
          on {{profile.lastUpdate | date:'MMM d, yyyy H:mm:ss'}} UTC.
        </em>
      </p>
    </div>
  </div>

  <h2>Social Activity</h2>
  <div class='row'>
    <div class='col-md-6'>
      <table class='table table-striped'>
        <thead>
          <tr>
            <th>Recent Posts <a href='/profile/{{id}}/posts'>(View All)</a></th>
          </tr>
        </thead>
        <tbody>
          <tr ng-if='posts.length == 0'>
            <td><em>No posts found.</em></td>
          </tr>
          <tr ng-repeat='post in posts'>
            <td>
              <img ng-if='post.attachmentUrl != null'
                   ng-src='{{api.authorizeUrl(post.attachmentUrl)}}'
                   class='post-attachment'>
              {{post.content}}
              <span class='text-muted'>
                {{post.upstreamCreated | date:'yyyy-MM-dd H:mm:ss'}}
              </span>
            </td>
          </tr>
        </tbody>
      </table>
    </div>

    <div class='col-md-3 col-sm-6'>
      <table class='table table-striped'>
        <thead>
          <tr>
            <th>Top Friends <a href='/profile/{{id}}/relations/friends'>
              (View All)</a>
            </th>
          </tr>
        </thead>
        <tbody>
          <tr ng-if='friends.length == 0'>
            <td><em>No friends found.</em></td>
          </tr>
          <tr ng-repeat='friend in friends'>
            <td>
              <img class='thumb'
                   ng-src='{{api.authorizeUrl(friend.avatarThumbUrl)}}'>
              <a href='/profile/{{friend.id}}'>{{friend.username}}</a>
            </td>
          </tr>
        </tbody>
      </table>
    </div>

    <div class='col-md-3 col-sm-6'>
      <table class='table table-striped'>
        <thead>
          <tr>
            <th>Top Followers <a href='/profile/{{id}}/relations/followers'>
              (View All)</a>
            </th>
          </tr>
        </thead>
        <tbody>
          <tr ng-if='followers.length == 0'>
            <td><em>No followers found.</em></td>
          </tr>
          <tr ng-repeat='follower in followers'>
            <td>
              <img class='thumb'
                   ng-src='{{api.authorizeUrl(follower.avatarThumbUrl)}}'>
              <a href='/profile/{{follower.id}}'>{{follower.username}}</a>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>

  <h2>Usernames</h2>
  <div class='row'>
    <div class='col-sm-12'>
      <p>
        <em>This profile is associated with the following usernames:</em>
      </p>

      <table class='table table-striped'>
        <thead>
          <tr>
            <th>Usernames</th>
            <th>First Seen</th>
            <th>Last Seen</th>
          </tr>
        </thead>
        <tbody>
          <tr ng-show='profile.usernames.length == 0'>
            <td colspan='100' class='no-rows'>No usernames found.</td>
          </tr>

          <tr ng-repeat='profileUsername in profile.usernames'>
            <td>{{profileUsername.username}}</td>
            <td>{{profileUsername.startDate != null ? (profileUsername.startDate | date) : 'N/A'}}</td>
            <td>{{profileUsername.endDate != null ? (profileUsername.endDate | date) : 'N/A'}}</td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>
</div>

