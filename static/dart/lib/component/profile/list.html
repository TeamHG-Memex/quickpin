<breadcrumbs crumbs=crumbs></breadcrumbs>

<div class='buttons'>

  <div class='btn-group pull-right'>
    <button type='button'
            class='btn btn-primary btn-sm dropdown-toggle'
            data-toggle='dropdown'
            aria-expanded='false'>
      Label: {{labelFilterDescription}} <span class='caret'></span>
    </button>
    <ul class='dropdown-menu sort-by' role='menu'>
      <li><a ng-click='filterLabels(null)'>All Labels</a></li>
      <li class='divider'></li>
      <li ng-repeat='label in labels'>
        <a ng-show="!labelFilters.contains(label.name)"
           ng-click='filterLabels(label.name)'>
          {{label.name}}
        </a>
        <a ng-show="labelFilters.contains(label.name)" 
           ng-click='filterLabelsRemove(label.name)'>
          <i class='fa fa-check'></i>
          {{label.name}}
        </a>
      </li>
    </ul>
  </div>

  
  <div class='btn-group pull-right'>
    <button type='button'
            class='btn btn-primary btn-sm dropdown-toggle'
            data-toggle='dropdown'
            aria-expanded='false'>
      Interesting: {{interestFilterDescription}} <span class='caret'></span>
    </button>
    <ul class='dropdown-menu sort-by' role='menu'>
      <li><a ng-click='filterInterest(null)'>All Profiles</a></li>
      <li class='divider'></li>

      <li><a ng-click='filterInterest("yes")'>Yes</a></li>
      <li><a ng-click='filterInterest("no")'>No</a></li>
      <li><a ng-click='filterInterest("unset")'>Unset</a></li>
    </ul>
  </div>

  <div class='btn-group pull-right'>
    <button type='button'
            class='btn btn-primary btn-sm dropdown-toggle'
            data-toggle='dropdown'
            aria-expanded='false'>
      Site: {{siteFilterDescription}} <span class='caret'></span>
    </button>
    <ul class='dropdown-menu sort-by' role='menu'>
      <li><a ng-click='filterSite(null)'>All Sites</a></li>
      <li class='divider'></li>
      <li><a ng-click='filterSite("instagram")'>Instagram</a></li>
      <li><a ng-click='filterSite("twitter")'>Twitter</a></li>
    </ul>
  </div>

  <div class='btn-group pull-right'>
    <a class='btn btn-primary btn-sm pull-right'
       ng-disabled='showAdd'
       ng-click='showAddDialog()'>
      <i class='fa fa-user-plus'></i>
      Add Profiles
    </a>
  </div>
</div>

<h1>
  Profiles
  <img ng-show='loading' src='/static/img/spinner-blue-on-white.gif'>
</h1>

<div class='alert alert-danger' role='alert' ng-show='error != null'>
  {{error}}
</div>

<div class='row'>
  <div class="col-sm-12">
    Showing {{pager.startingAt | number}}-{{pager.endingAt | number}}
    of {{pager.totalResults | number}} profiles.
  </div>
</div>

<form ng-show='showAdd' class='form-inline add-profile-form'>
  <div class='form-group'>
    <div class='input-group'>
      <div class='input-group-addon'><strong>Add Profile</strong></div>
      <input type='text'
             id='newProfile'
             class='form-control'
             ng-model='newProfile'
             ng-keypress='handleAddProfileKeypress($event)'
             ng-disabled='submittingProfile'
             placeholder='Enter a username and select a site.'>
    </div>
  </div>

  <div class='btn-group'>
    <button type='button'
            class='btn btn-default dropdown-toggle'
            data-toggle='dropdown'
            ng-disabled='submittingProfile'
            aria-expanded='false'>
      {{newProfileSiteDescription}} <span class='caret'></span>
    </button>
    <ul class='dropdown-menu sort-by' role='menu'>
      <li><a ng-click='selectAddProfileSite("instagram")'>Instagram</a></li>
      <li><a ng-click='selectAddProfileSite("twitter")'>Twitter</a></li>
    </ul>
  </div>

  <button class='btn btn-success'
          ng-click='addProfile()'
          ng-disabled='submittingProfile'>
    <i class='fa fa-user-plus'></i>
    Add
  </button>

  <button class='btn btn-danger'
          ng-click='hideAddDialog()'
          ng-disabled='submittingProfile'>
    <i class='fa fa-times'></i>
    Cancel
  </button>
</form>

<div class="row">
  <div class="col-sm-12">
    <pager pager='pager'
          disabled='loading'></pager>
  </div>
</div>

<masonry column-width='250' column-gap='25'>
  <div ng-repeat='profile in profiles' class='masonry-item'>
    <a ng-href='{{profile.id != null ? "/profile/" + profile.id : ""}}'>
      <img class='avatar' ng-src='{{api.authorizeUrl(profile.avatarUrl)}}'>
    </a>
    <p class='profile-name'>
      <a ng-show='profile.id != null' href='/profile/{{profile.id}}'>
        {{profile.username}}
      </a>
      <span ng-show='profile.id == null'>
        {{profile.username}}
      </span>
      <span class='site-name'>
        <i class='fa {{profile.iconClass()}}' title='{{profile.siteName}}'></i>
      </span>
    </p>
    <div class='loading'
         ng-show='profile.id == null && profile.error == null'>
      <img src='/static/img/horizontal-loader.gif' alt='Loading…'><br>
      <em>Loading…</em>
    </div>
    <p class='alert alert-danger alert-dismissible'
       role='alert'
       ng-show='profile.error != null'>
      <button type='button'
              class='close'
              data-dismiss='alert'
              aria-label='Close'
              ng-click='dismissProfileAtIndex($index)'>
      <span aria-hidden='true'>&times;</span></button>
      <strong>Error:</strong> {{profile.error}}
    </p>
    <p ng-show='profile.description != null'>
      {{profile.description}}
    </p>
    <div class='info' ng-show='profile.location != null'>
      <strong class='text-muted'>Name:</strong>
      {{profile.name}}
    </div>
    <div class='info' ng-show='profile.location != null'>
      <strong class='text-muted'>Location:</strong>
      {{profile.location}}
    </div>
    <p ng-show='profile.postCount != null'>
      <em>
        {{profile.friendCount | largeNumber:1}} friends,
        {{profile.followerCount | largeNumber:1}} followers, and
        {{profile.postCount | largeNumber:1}} posts.
      </em>
    </p>
    <div class="btn-group btn-group-sm" ng-show="profile.id != null" role="group" aria-label="...">
      <button 
          type="button" 
          ng-class="profile.isInteresting==true ? 'btn btn-success' : profile.isInteresting==false ? 'btn btn-danger' : 'btn btn-default'"
          disabled>
          {{profile.isInteresting==false ? "Not interesting" : profile.isInteresting==true ? "Interesting" : "Interesting?"}}
      </button>
      <button 
          type="button" 
          ng-click='setProfileInterestAtIndex($index,true)'
          ng-class="profile.isInteresting==true ? 'btn btn-success' : 'btn btn-default'">
          <span class="fa fa-check"></span>
      </button>
      <button 
          type="button" 
          ng-click='setProfileInterestAtIndex($index,false)' 
          ng-class="profile.isInteresting==false ? 'btn btn-danger rounded-right' : 'btn btn-default rounded-right'">
          <span class="fa fa-remove"></span>
      </button>
      <button 
          ng-click="setProfileInterestAtIndex($index)" 
          ng-show="profile.isInteresting != null"
          class="btn btn-link">
          clear
      </button>
    </div>
</masonry>

<p ng-show='profiles.length == 0 && siteFilter == null'>
  There are currently no profiles. Try clicking "Add Profiles" to get started.
</p>
<p ng-show='profiles.length == 0 && siteFilter != null'> No profiles match the current filter. Try changing the filter or click "Add Profiles" to add new profiles.  </p>
